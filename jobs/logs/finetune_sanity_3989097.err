/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/mmcv/cnn/bricks/transformer.py:32: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
wandb: [wandb.login()] Loaded credentials for https://api.wandb.ai from WANDB_API_KEY.
wandb: Currently logged in as: winnerabula55 (winnerabula55-khalifa-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: setting up run qnaf2duq
wandb: Tracking run with wandb version 0.24.2
wandb: Run data is saved locally in /dpc/kuin0137/LoRA_Experiment/classification/Updated_Vanilla/Skysense_FoundationModel_Finetuning/wandb/run-20260210_114532-qnaf2duq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kind-mountain-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/winnerabula55-khalifa-university/LoRA_resisc45_sanity
wandb: üöÄ View run at https://wandb.ai/winnerabula55-khalifa-university/LoRA_resisc45_sanity/runs/qnaf2duq
/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/functional.py:554: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4322.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Generating train split:   0%|          | 0/18900 [00:00<?, ? examples/s]Generating train split:  13%|‚ñà‚ñé        | 2400/18900 [00:00<00:01, 15097.29 examples/s]Generating train split:  38%|‚ñà‚ñà‚ñà‚ñä      | 7200/18900 [00:00<00:00, 28163.58 examples/s]Generating train split:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 12000/18900 [00:00<00:00, 32695.26 examples/s]Generating train split:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 16800/18900 [00:00<00:00, 35662.26 examples/s]Generating train split: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 18900/18900 [00:00<00:00, 21023.44 examples/s]
Generating validation split:   0%|          | 0/6300 [00:00<?, ? examples/s]Generating validation split:  38%|‚ñà‚ñà‚ñà‚ñä      | 2400/6300 [00:00<00:00, 21339.31 examples/s]Generating validation split: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6300/6300 [00:00<00:00, 19122.59 examples/s]
Generating test split:   0%|          | 0/6300 [00:00<?, ? examples/s]Generating test split:  38%|‚ñà‚ñà‚ñà‚ñä      | 2400/6300 [00:00<00:00, 21985.61 examples/s]Generating test split: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 6300/6300 [00:00<00:00, 18518.27 examples/s]
Train:   0%|          | 0/99 [00:00<?, ?it/s]                                             Traceback (most recent call last):
  File "/dpc/kuin0137/LoRA_Experiment/classification/Updated_Vanilla/Skysense_FoundationModel_Finetuning/train_resisc45_lora.py", line 81, in <module>
    train_loss, train_acc = train_one_epoch(model, train_loader, optimizer, criterion, device)
  File "/dpc/kuin0137/LoRA_Experiment/classification/Updated_Vanilla/Skysense_FoundationModel_Finetuning/train_resisc45_lora.py", line 23, in train_one_epoch
    logits = model(x)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/peft/peft_model.py", line 2898, in forward
    return self.base_model(
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/peft/tuners/tuners_utils.py", line 222, in forward
    return self.model.forward(*args, **kwargs)
TypeError: forward() got an unexpected keyword argument 'input_ids'
Traceback (most recent call last):
  File "/dpc/kuin0137/LoRA_Experiment/classification/Updated_Vanilla/Skysense_FoundationModel_Finetuning/train_resisc45_lora.py", line 81, in <module>
    train_loss, train_acc = train_one_epoch(model, train_loader, optimizer, criterion, device)
  File "/dpc/kuin0137/LoRA_Experiment/classification/Updated_Vanilla/Skysense_FoundationModel_Finetuning/train_resisc45_lora.py", line 23, in train_one_epoch
    logits = model(x)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/peft/peft_model.py", line 2898, in forward
    return self.base_model(
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kunet.ae/100066896/.local/lib/python3.9/site-packages/peft/tuners/tuners_utils.py", line 222, in forward
    return self.model.forward(*args, **kwargs)
TypeError: forward() got an unexpected keyword argument 'input_ids'
srun: error: gpu-11-3: task 0: Exited with exit code 1
